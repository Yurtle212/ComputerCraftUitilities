local yurtle = require "yurtle"
if (fs.exists("startup")) then
    print("Controller Turtle")
    shell.run("startup")
    error()
else
    print("Miner Turtle")
end

shell.run("delete hiveminer.lua")
shell.run("wget https://raw.githubusercontent.com/Yurtle212/ComputerCraftUitilities/main/minecraft/turtles/hiveminer/hiveminer.lua")

shell.run("delete yurtle.lua")
shell.run("wget https://raw.githubusercontent.com/Yurtle212/ComputerCraftUitilities/main/minecraft/turtles/yurtle.lua")

shell.run("delete json")
shell.run("wget https://pastebin.com/raw/4nRg9CHU json")

local modem = peripheral.wrap("front")
modem.open(1)

modem.transmit(1, 1, turtle.getFuelLevel())

os.pullEvent("modem_message")

yurtle.refuel()

modem.transmit(1, 1, "refueled")

local event, sender, message, protocol = os.pullEvent("modem_message")

if (message.equipLeft ~= nil) then
    local slot = yurtle.findItemInInventory(message.equipLeft)
    if (slot ~= nil) then
        turtle.select(slot)
        turtle.equipLeft()
    end
end

if (message.equipRight ~= nil) then
    local slot = yurtle.findItemInInventory(message.equipRight)
    if (slot ~= nil) then
        turtle.select(slot)
        turtle.equipRight()
    end
end

modem.transmit(1, 1, "equipped")